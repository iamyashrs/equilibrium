/**
 * version 2.0.0
 * @license
 * =========================================================
 * bootstrap-datetimepicker.js
 * http://www.eyecon.ro/bootstrap-datepicker
 * =========================================================
 * Copyright 2012 Stefan Petre
 *
 * Contributions:
 *  - Andrew Rowls
 *  - Thiago de Arruda
 *  - updated for Bootstrap v3 by Jonathan Peterson @Eonasdan
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =========================================================
 */
(function(c){var b=0,a=function(f,h){var r={pickDate:true,pickTime:true,startDate:moment({y:1970}),endDate:moment().add(50,"y"),collapse:true,language:"en",defaultDate:"",disabledDates:[]},p=this,C=function(){var K=false,J,L;p.options=c.extend({},r,h);if(!(p.options.pickTime||p.options.pickDate)){throw new Error("Must choose at least one picker")}p.id=b++;moment.lang(p.options.language);p.date=moment();p.element=c(f);p.unset=false;p.isInput=p.element.is("input");p.component=false;if(p.element.hasClass("input-group")){p.component=p.element.find(".input-group-addon")}p.format=p.options.format;if(!p.format){if(p.isInput){p.format=p.element.data("format")}else{p.format=p.element.find("input").data("format")}if(!p.format){p.format=(p.options.pickDate?"L":"")}p.format+=(p.options.pickTime?" LT":"")}if(p.component){K=p.component.find("span")}if(p.options.pickTime){if(K&&K.length){p.timeIcon=K.data("time-icon");p.upIcon=K.data("up-icon");p.downIcon=K.data("down-icon")}if(!p.timeIcon){p.timeIcon="glyphicon glyphicon-time"}if(!p.upIcon){p.upIcon="glyphicon glyphicon-chevron-up"}if(!p.downIcon){p.downIcon="glyphicon glyphicon-chevron-down"}if(K){K.addClass(p.timeIcon)}}if(p.options.pickDate){if(K&&K.length){p.dateIcon=K.data("date-icon")}if(!p.dateIcon){p.dateIcon="glyphicon glyphicon-calendar"}if(K){K.removeClass(p.timeIcon);K.addClass(p.dateIcon)}}p.widget=c(G(p.timeIcon,p.upIcon,p.downIcon,p.options.pickDate,p.options.pickTime,p.options.collapse)).appendTo("body");p.minViewMode=p.options.minViewMode||p.element.data("date-minviewmode")||0;if(typeof p.minViewMode==="string"){switch(p.minViewMode){case"months":p.minViewMode=1;break;case"years":p.minViewMode=2;break;default:p.minViewMode=0;break}}p.viewMode=p.options.viewMode||p.element.data("date-viewmode")||0;if(typeof p.viewMode==="string"){switch(p.viewMode){case"months":p.viewMode=1;break;case"years":p.viewMode=2;break;default:p.viewMode=0;break}}for(J in p.options.disabledDates){L=p.options.disabledDates[J];L=moment(L);if(!L.isValid){L=moment(startDate).subtract(1,"day").format("L")}p.options.disabledDates[J]=L.format("L")}p.startViewMode=p.viewMode;p.setStartDate(p.options.startDate||p.element.data("date-startdate"));p.setEndDate(p.options.endDate||p.element.data("date-enddate"));F();I();k();A();m();e();H();if(p.options.defaultDate!==""){p.setValue(p.options.defaultDate)}},n=function(){var J="absolute",L=p.component?p.component.offset():p.element.offset(),K=c(window);p.width=p.component?p.component.outerWidth():p.element.outerWidth();L.top=L.top+p.element.outerHeight();if(p.options.width!==undefined){p.widget.width(p.options.width)}if(p.options.orientation==="left"){p.widget.addClass("left-oriented");L.left=L.left-p.widget.width()+20}if(y()){J="fixed";L.top-=K.scrollTop();L.left-=K.scrollLeft()}if(K.width()<L.left+p.widget.outerWidth()){L.right=K.width()-L.left-p.width;L.left="auto";p.widget.addClass("pull-right")}else{L.right="auto";p.widget.removeClass("pull-right")}p.widget.css({position:J,top:L.top,left:L.left,right:L.right})},x=function(){p.element.trigger({type:"change.dp",date:p.getDate()})},m=function(J){moment.lang(p.options.language);var K=J;if(!K){if(p.isInput){K=p.element.val()}else{K=p.element.find("input").val()}if(K){p.date=moment(K)}if(!p.date){p.date=moment()}}p.viewDate=moment(p.date).startOf("month");g();w()},F=function(){moment.lang(p.options.language);var J=moment().weekday(0).weekday(),K=c("<tr>");while(J<moment().weekday(0).weekday()+7){K.append('<th class="dow">'+moment()._lang._weekdaysMin[(J++)%7]+"</th>")}p.widget.find(".datepicker-days thead").append(K)},I=function(){var K="",J=0;while(J<12){K+='<span class="month">'+moment()._lang._monthsShort[J++]+"</span>"}p.widget.find(".datepicker-months td").append(K)},g=function(){moment.lang(p.options.language);var T=p.viewDate.year(),R=p.viewDate.month(),S=p.options.startDate.year(),V=p.options.startDate.month(),W=p.options.endDate.year(),P=p.options.endDate.month(),L,O,N=[],X,K,M,U,J,Q;p.widget.find(".datepicker-days").find(".disabled").removeClass("disabled");p.widget.find(".datepicker-months").find(".disabled").removeClass("disabled");p.widget.find(".datepicker-years").find(".disabled").removeClass("disabled");p.widget.find(".datepicker-days th:eq(1)").text(moment()._lang._months[R]+" "+T);L=moment(p.viewDate).subtract("months",1);U=L.daysInMonth();L.date(U).startOf("week");if((T==S&&R<=V)||T<S){p.widget.find(".datepicker-days th:eq(0)").addClass("disabled")}if((T==W&&R>=P)||T>W){p.widget.find(".datepicker-days th:eq(2)").addClass("disabled")}O=moment(L).add(42,"d");while(L.isBefore(O)){if(L.weekday()===moment().startOf("week").weekday()){X=c("<tr>");N.push(X)}K="";if(L.year()<T||(L.year()==T&&L.month()<R)){K+=" old"}else{if(L.year()>T||(L.year()==T&&L.month()>R)){K+=" new"}}if(L===p.viewDate){K+=" active"}if((moment(L).add(1,"d")<=p.options.startDate)||(L>p.options.endDate)||d(L)){K+=" disabled"}X.append('<td class="day'+K+'">'+L.date()+"</td>");L.add(1,"d")}p.widget.find(".datepicker-days tbody").empty().append(N);Q=moment().year(),months=p.widget.find(".datepicker-months").find("th:eq(1)").text(T).end().find("span").removeClass("active");if(Q===T){months.eq(moment().month()).addClass("active")}if(Q-1<S){p.widget.find(".datepicker-months th:eq(0)").addClass("disabled")}if(Q+1>W){p.widget.find(".datepicker-months th:eq(2)").addClass("disabled")}for(M=0;M<12;M++){if((T==S&&V>M)||(T<S)){c(months[M]).addClass("disabled")}else{if((T==W&&P<M)||(T>W)){c(months[M]).addClass("disabled")}}}N="";T=parseInt(T/10,10)*10;J=p.widget.find(".datepicker-years").find("th:eq(1)").text(T+"-"+(T+9)).end().find("td");p.widget.find(".datepicker-years").find("th").removeClass("disabled");if(S>T){p.widget.find(".datepicker-years").find("th:eq(0)").addClass("disabled")}if(W<T+9){p.widget.find(".datepicker-years").find("th:eq(2)").addClass("disabled")}T-=1;for(M=-1;M<11;M++){N+='<span class="year'+(M===-1||M===10?" old":"")+(Q===T?" active":"")+((T<S||T>W)?" disabled":"")+'">'+T+"</span>";T+=1}J.html(N)},k=function(){var M=p.widget.find(".timepicker .timepicker-hours table"),L="",N,K,J;M.parent().hide();N=0;for(K=0;K<6;K+=1){L+="<tr>";for(J=0;J<4;J+=1){L+='<td class="hour">'+B(N.toString())+"</td>";N++}L+="</tr>"}M.html(L)},A=function(){var M=p.widget.find(".timepicker .timepicker-minutes table"),L="",N=0,K,J;M.parent().hide();for(K=0;K<5;K++){L+="<tr>";for(J=0;J<4;J+=1){L+='<td class="minute">'+B(N.toString())+"</td>";N+=3}L+="</tr>"}M.html(L)},w=function(){if(!p.date){return}var L=p.widget.find(".timepicker span[data-time-component]"),J=p.date.hours(),K="AM";if(J>=12){K="PM"}if(J===0){J=12}else{if(J!=12){J=J%12}}p.widget.find(".timepicker [data-action=togglePeriod]").text(K);L.filter("[data-time-component=hours]").text(B(J));L.filter("[data-time-component=minutes]").text(B(p.date.minutes()))},z=function(O){O.stopPropagation();O.preventDefault();p.unset=false;var N=c(O.target).closest("span, td, th"),M,K,L,J;if(N.length===1){if(!N.is(".disabled")){switch(N[0].nodeName.toLowerCase()){case"th":switch(N[0].className){case"switch":e(1);break;case"prev":case"next":L=E.modes[p.viewMode].navStep;if(N[0].className==="prev"){L=L*-1}p.viewDate.add(L,E.modes[p.viewMode].navFnc);g();break}break;case"span":if(N.is(".month")){M=N.parent().find("span").index(N);p.viewDate.month(M)}else{K=parseInt(N.text(),10)||0;p.viewDate.year(K)}if(p.viewMode!==0){p.date=moment({y:p.viewDate.year(),M:p.viewDate.month(),d:p.viewDate.date(),h:p.date.hours(),m:p.date.minutes()});x()}e(-1);g();break;case"td":if(N.is(".day")){J=parseInt(N.text(),10)||1;M=p.viewDate.month();K=p.viewDate.year();if(N.is(".old")){if(M===0){M=11;K-=1}else{M-=1}}else{if(N.is(".new")){if(M==11){M=0;K+=1}else{M+=1}}}p.date=moment({y:K,M:M,d:J,h:p.date.hours(),m:p.date.minutes()});p.viewDate=moment({y:K,M:M,d:Math.min(28,J)});g();v();x()}break}}}},q={incrementHours:function(){i("add","hours")},incrementMinutes:function(){i("add","minutes")},decrementHours:function(){i("subtract","hours")},decrementMinutes:function(){i("subtract","hours")},togglePeriod:function(){var J=p.date.hours();if(J>=12){J-=12}else{J+=12}p.date.hours(J)},showPicker:function(){p.widget.find(".timepicker > div:not(.timepicker-picker)").hide();p.widget.find(".timepicker .timepicker-picker").show()},showHours:function(){p.widget.find(".timepicker .timepicker-picker").hide();p.widget.find(".timepicker .timepicker-hours").show()},showMinutes:function(){p.widget.find(".timepicker .timepicker-picker").hide();p.widget.find(".timepicker .timepicker-minutes").show()},selectHour:function(J){p.date.hours(parseInt(c(J.target).text(),10));q.showPicker.call(p)},selectMinute:function(J){p.date.minutes(parseInt(c(J.target).text(),10));q.showPicker.call(p)}},u=function(K){D(K);if(!p.date){p.date=moment({y:1970})}var J=c(K.currentTarget).data("action"),L=q[J].apply(p,arguments);v();w();x();return L},D=function(J){J.stopPropagation();J.preventDefault()},t=function(K){var J=c(K.target),L=J.val();if(p.date.isValid){m();p.setValue(p.date.getTime());x();v()}else{if(L&&L.trim()){p.setValue(p.date.getTime());if(p.date.isValid){v()}else{J.val("")}}else{if(p.date.isValid){p.setValue(null);x();p.unset=true}}}},e=function(J){if(J){p.viewMode=Math.max(p.minViewMode,Math.min(2,p.viewMode+J))}p.widget.find(".datepicker > div").hide().filter(".datepicker-"+E.modes[p.viewMode].clsName).show()},H=function(){var L=this,O,N,K,J,M;p.widget.on("click",".datepicker *",c.proxy(z,this));p.widget.on("click","[data-action]",c.proxy(u,this));p.widget.on("mousedown",c.proxy(D,this));if(p.options.pickDate&&p.options.pickTime){p.widget.on("click.togglePicker",".accordion-toggle",function(P){P.stopPropagation();O=c(this);N=O.closest("ul");K=N.find(".in");J=N.find(".collapse:not(.in)");if(K&&K.length){M=K.data("collapse");if(M&&M.transitioning){return}K.collapse("hide");J.collapse("show");O.find("span").toggleClass(L.timeIcon+" "+L.dateIcon);p.element.find(".input-group-addon span").toggleClass(L.timeIcon+" "+L.dateIcon)}})}if(p.isInput){p.element.on({focus:c.proxy(p.show,this),change:c.proxy(t,this),blur:c.proxy(p.hide,this)})}else{p.element.on({change:c.proxy(t,this)},"input");if(p.component){p.component.on("click",c.proxy(p.show,this))}else{p.element.on("click",c.proxy(p.show,this))}}},o=function(){c(window).on("resize.datetimepicker"+p.id,c.proxy(n,this));if(!p.isInput){c(document).on("mousedown.datetimepicker"+p.id,c.proxy(p.hide,this))}},s=function(){p.widget.off("click",".datepicker *",p.click);p.widget.off("click","[data-action]");p.widget.off("mousedown",p.stopEvent);if(p.options.pickDate&&p.options.pickTime){p.widget.off("click.togglePicker")}if(p.isInput){p.element.off({focus:p.show,change:p.change})}else{p.element.off({change:p.change},"input");if(p.component){p.component.off("click",p.show)}else{p.element.off("click",p.show)}}},j=function(){c(window).off("resize.datetimepicker"+p.id);if(!p.isInput){c(document).off("mousedown.datetimepicker"+p.id)}},y=function(){if(p.element){var K=p.element.parents(),J=false,L;for(L=0;L<K.length;L++){if(c(K[L]).css("position")=="fixed"){J=true;break}}return J}else{return false}},v=function(){moment.lang(p.options.language);var K="",J;if(!p.unset){K=moment(p.date).format(p.format)}if(!p.isInput){if(p.component){J=p.element.find("input");J.val(K)}p.element.data("date",K)}else{p.element.val(K)}if(!p.options.pickTime){p.hide()}},i=function(L,K){moment.lang(p.options.language);var J;if(L=="add"){J=moment(p.date);if(J.hours()==23){J.add(1,K)}J.add(1,K)}else{J=moment(p.date).subtract(1,K)}if(J.isAfter(p.options.endDate)||J.subtract(1,K).isBefore(p.options.startDate)){return}if(d(J)){return}if(L=="add"){p.date.add(1,K)}else{p.date.subtract(1,K)}},d=function(J){moment.lang(p.options.language);var L=p.options.disabledDates,K;for(K in L){if(L[K]==moment(J).format("L")){return true}}return false},B=function(J){J=J.toString();if(J.length>=2){return J}else{return"0"+J}},G=function(M,O,L,K,J,N){if(K&&J){return('<div class="bootstrap-datetimepicker-widget dropdown-menu" style="z-index:9999 !important;"><ul class="list-unstyled"><li'+(N?' class="collapse in"':"")+'><div class="datepicker">'+E.template+'</div></li><li class="picker-switch accordion-toggle"><a class="btn" style="width:100%"><span class="'+M+'"></span></a></li><li'+(N?' class="collapse"':"")+'><div class="timepicker">'+l.getTemplate(O,L)+"</div></li></ul></div>")}else{if(J){return('<div class="bootstrap-datetimepicker-widget dropdown-menu"><div class="timepicker">'+l.getTemplate(O,L)+"</div></div>")}else{return('<div class="bootstrap-datetimepicker-widget dropdown-menu"><div class="datepicker">'+E.template+"</div></div>")}}},E={modes:[{clsName:"days",navFnc:"month",navStep:1},{clsName:"months",navFnc:"year",navStep:1},{clsName:"years",navFnc:"year",navStep:10}],headTemplate:'<thead><tr><th class="prev">&lsaquo;</th><th colspan="5" class="switch"></th><th class="next">&rsaquo;</th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>'},l={hourTemplate:'<span data-action="showHours" data-time-component="hours" class="timepicker-hour"></span>',minuteTemplate:'<span data-action="showMinutes" data-time-component="minutes" class="timepicker-minute"></span>'};E.template='<div class="datepicker-days"><table class="table-condensed">'+E.headTemplate+'<tbody></tbody></table></div><div class="datepicker-months"><table class="table-condensed">'+E.headTemplate+E.contTemplate+'</table></div><div class="datepicker-years"><table class="table-condensed">'+E.headTemplate+E.contTemplate+"</table></div>";l.getTemplate=function(K,J){return('<div class="timepicker-picker"><table class="table-condensed"><tr><td><a href="#" class="btn" data-action="incrementHours"><span class="'+K+'"></span></a></td><td class="separator"></td><td><a href="#" class="btn" data-action="incrementMinutes"><span class="'+K+'"></span></a></td><td class="separator"></td></tr><tr><td>'+l.hourTemplate+'</td> <td class="separator">:</td><td>'+l.minuteTemplate+'</td> <td class="separator"></td><td><button type="button" class="btn btn-primary" data-action="togglePeriod"></button></td></tr><tr><td><a href="#" class="btn" data-action="decrementHours"><span class="'+J+'"></span></a></td><td class="separator"></td><td><a href="#" class="btn" data-action="decrementMinutes"><span class="'+J+'"></span></a></td><td class="separator"></td></tr></table></div><div class="timepicker-hours" data-action="selectHour"><table class="table-condensed"></table></div><div class="timepicker-minutes" data-action="selectMinute"><table class="table-condensed"></table></div>')};p.destroy=function(){s();j();p.widget.remove();p.element.removeData("DateTimePicker");p.component.removeData("DateTimePicker")};p.show=function(J){p.widget.show();p.height=p.component?p.component.outerHeight():p.element.outerHeight();n();p.element.trigger({type:"show.dp",date:p.date});o();if(J){D(J)}},p.disable=function(){p.element.find("input").prop("disabled",true);s()},p.enable=function(){p.element.find("input").prop("disabled",false);H()},p.hide=function(){var L=p.widget.find(".collapse"),J,K;for(J=0;J<L.length;J++){K=L.eq(J).data("collapse");if(K&&K.transitioning){return}}p.widget.hide();p.viewMode=p.startViewMode;e();p.element.trigger({type:"hide.dp",date:p.date});j()},p.setValue=function(J){moment.lang(p.options.language);if(!J){p.unset=true}else{p.unset=false}var K=moment(J);if(!K.isValid()){throw new Error("Couldn't parase date or is invalid")}p.date=K;v();p.viewDate=moment({y:p.date.year(),M:p.date.month()});g();w()},p.getDate=function(){if(p.unset){return null}return p.date},p.setDate=function(J){if(!J){p.setValue(null)}else{p.setValue(J)}},p.setEndDate=function(J){p.options.endDate=moment(J);if(!p.options.endDate.isValid){p.options.endDate=moment().add(50,"y")}if(p.viewDate){m()}},p.setStartDate=function(J){p.options.startDate=moment(J);if(!p.options.startDate.isValid){p.options.startDate=moment({y:1970})}if(p.viewDate){m()}};C()};c.fn.datetimepicker=function(d){return this.each(function(){var f=c(this),e=f.data("DateTimePicker");if(!e){f.data("DateTimePicker",new a(this,d))}})}})(jQuery);